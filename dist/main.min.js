"use strict";function o(e){return i(e)||t(e)||r(e)||n()}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,n){if(e){if("string"==typeof e)return s(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,n):void 0}}function t(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function i(e){if(Array.isArray(e))return s(e)}function s(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function a(n,e){var r,t=Object.keys(n);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(n),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})),t.push.apply(t,r)),t}function c(n){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach(function(e){u(n,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(r,e))})}return n}function u(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}var l=require("path"),p=require("fs"),e=require("process"),m=require("glob"),f=e.cwd(),g=l.resolve(f,"src/pages"),b=g.length+1,y=require("simple-progress-webpack-plugin"),d=require("compression-webpack-plugin"),h=require("webpack-bundle-analyzer"),O=h.BundleAnalyzerPlugin,j=require("terser-webpack-plugin"),v=require("optimize-css-assets-webpack-plugin"),k=function(i,o){var e,n,r=m.sync(g+"/*/main.js"),s={},a=[];return o||i||(e=l.resolve(f,"config/local.json"),p.existsSync(e)&&(n=p.readFileSync(e),a=[].concat(JSON.parse(n.toString()).modules))),r.forEach(function(e){var n,r,t=l.dirname(e).substr(b);(o||i||a.includes(t))&&(n=l.resolve("".concat(g,"/").concat(t,"/env.json")),r={title:"首页",keywords:null,description:null},p.existsSync(n)&&(r=Object.assign({},r,JSON.parse(p.readFileSync(n).toString()))),i&&"examples"===t||(s[t]=Object.assign({},r,{entry:"src/pages/".concat(t,"/main.js"),template:"public/".concat("login"===t?"login":"index",".html"),filename:"".concat(t,i?"/index.html":".html"),chunks:["vendors","commons",t]})))}),s};exports.pages=k,exports.margin=function(r,t){var i=k(r);return{publicPath:t.prefix(r),outputDir:"dist",assetsDir:"static",pages:i,indexPath:"index.html",productionSourceMap:!r,chainWebpack:function(e){t.alias(e),Object.keys(i).forEach(function(n){e.plugin("html-".concat(n)).tap(function(e){return e[0].cdn=t.static(t.prefix(r))(n),e})});var n=c(c({},e.module.rule("scss").toConfig().oneOf[3]),{},{test:/\.useable.scss$/});n.use=o(n.use),n.use[0]={loader:"style-loader",options:{injectType:"lazyStyleTag"}},e.module.rule("scss").merge({oneOf:[n]}),t.chainWebpack&&"function"==typeof t.chainWebpack&&t.chainWebpack(e)},configureWebpack:function(e){e.externals=t.externals,e.performance={hints:"warning",maxEntrypointSize:5e7,maxAssetSize:3e7,assetFilter:function(e){return e.endsWith(".js")}},r&&e.plugins.push(new d({filename:"[path].gz[query]",algorithm:"gzip",test:new RegExp("\\.("+["html","js","css"].join("|")+")$"),threshold:10240,minRatio:.6,deleteOriginalAssets:!1}),new O({openAnalyzer:!1,analyzerMode:"static"})),e.optimization={splitChunks:{chunks:"all",minSize:3e4,maxInitialRequests:1/0,minChunks:1,maxAsyncRequests:5,automaticNameDelimiter:".",name:!1,cacheGroups:{commons:{name:"commons",priority:1,chunks:"initial",minSize:0,minChunks:1},vendors:{name:"vendors",priority:2,test:/[\\/]node_modules[\\/]/,chunks:"initial",minSize:0,minChunks:1}}},minimizer:[new j({cache:!0,parallel:!0,sourceMap:!1,terserOptions:{compress:{drop_console:t.dropConsole,drop_debugger:t.dropDebugger}}}),new v({cssProcessorOptions:{safe:!0}})]},e.plugins.push(new y({format:"minimal"})),t.configureWebpack&&"function"==typeof t.configureWebpack&&t.configureWebpack(e)},devServer:t.devServer,parallel:1<require("os").cpus().length}};